# 作業ログ 2025-12-29

## 実施内容: 広告バナー機能の導入

### 概要
neuvecom-common をsubmoduleとして追加し、バリューコマースアフィリエイト広告バナーをGitHub Pagesサイトに導入した。

### 要件
- **submodule**: neuvecom-common（プライベートリポジトリ）
- **使用ファイル**: affiliate-lite.js, affiliate.css, adblock-detector.js, fallback.css
- **SID**: 3757792
- **storageKeyPrefix**: 'github-copilot-voice-hooks'
- **広告配置**: ページ上部（ヘッダー下）、468x60サイズ
- **フォールバック画像パス**: 'common/img/'
- **デプロイ方式**: GitHub Actions（SUBMODULE_PAT設定済み）

### 実施した変更

#### 1. submodule追加
```bash
git submodule add https://github.com/neuvecom/neuvecom-common.git neuvecom-common
```

#### 2. GitHub Actions ワークフロー作成
- `.github/workflows/deploy-pages.yml` を新規作成
- プライベートsubmoduleのチェックアウト対応（SUBMODULE_PAT使用）
- neuvecom-commonのリソースをdocs/common/にコピー
- data/affiliates.yamlをdocs/data/にコピー

#### 3. 広告設定ファイル作成
- `data/affiliates.yaml` を新規作成
- headerセクションに4つの広告を設定

#### 4. docs/index.html 修正
- CSSの追加（affiliate.css, fallback.css）
- 広告バナーコンテナの追加（ヘッダー直後）
- JavaScript初期化コードの追加

#### 5. .gitignore 作成
- `docs/common/` を追加（GitHub Actionsでコピーされるため）

### 修正対応

#### 修正1: API呼び出しの修正
- クラス名: `AffiliateManager` → `NeuvecomAffiliateBanner`
- メソッド: `renderBanner()` → `render()`
- パラメータ名: `fallbackImagePath` → `fallbackImagesPath`

#### 修正2: パス設定の修正
- `configPath`: 絶対パス → 相対パス `'data/affiliates.yaml'`
- `fallbackImagesPath`: 絶対パス → 相対パス `'common/img/'`
- ワークフローでdata/affiliates.yamlをdocs/data/にコピー

### コミット履歴
1. `[feat] 広告バナー機能を導入（GitHub Actions移行）`
2. `[fix] 広告バナーのAPI呼び出しを修正`
3. `[fix] affiliates.yamlのパスを修正`

### 残作業（手動）
- GitHub Pages設定: Settings > Pages > Source を「GitHub Actions」に変更（完了済み）

### 動作確認
- https://neuvecom.github.io/github-copilot-voice-hooks/ で広告バナー表示を確認済み
